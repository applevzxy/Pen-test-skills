# XSS 渗透测试报告模板

## 1. 测试概览

### 1.1 基本信息
- **测试目标**: [目标 URL/应用程序]
- **测试时间**: [日期]
- **测试人员**: [姓名]
- **测试范围**: [范围描述]

### 1.2 测试结果摘要

| 级别 | 状态 | 漏洞类型 | 风险等级 |
|------|------|----------|----------|
| [编号] | [✓/✗] | [类型] | [高/中/低] |

**成功利用**: [数量]/[总数] ([百分比]%)

---

## 2. 详细测试结果

### 2.1 [漏洞名称]

**测试位置**: [URL/参数/输入点]

**漏洞类型**: [反射型/存储型/DOM 型]

**服务器代码**:
```javascript
[相关代码片段]
```

**漏洞分析**:
- [分析点 1]
- [分析点 2]
- [关键冷知识]

**成功 Payload**:
```
[Payload 内容]
```

**攻击原理**:
1. [步骤 1]
2. [步骤 2]
3. [步骤 3]
4. [结果验证]

**风险等级**: [高/中/低]
**CVSS 评分**: [评分] ([等级])

**修复建议**:
- [建议 1]
- [建议 2]
- [建议 3]

---

## 3. 核心知识点总结

### 3.1 标签与注释相关

1. **两种 HTML 注释符**：
   - 常规：`<!-- -->`
   - 冷门：`<!-- --!>`

2. **不闭合标签执行**：
   - 部分标签无需完整闭合，只要事件属性存在即可触发执行
   - 示例：`<svg/onload=alert(1)>`

3. **空格闭合标签**：
   - `</style >`（style 后加空格）可绕过过滤且正常闭合标签

### 3.2 过滤绕过技巧

1. **双写绕过**：
   - `scrscriptipt` 过滤后变为 `script`

2. **回车换行绕过**：
   - `onfocus` 与 `=` 间换行，突破 `on.*=` 正则

3. **特殊字符绕过**：
   - 古英文字符 `ſ`：替代 `s`，大写为 `S`，不被 `[a-zA-Z]` 过滤

4. **实体编码绕过**：
   - HTML 实体编码在页面渲染时自动转换为原字符，且转换不受大写影响

### 3.3 JavaScript 与事件相关

1. **函数调用替代**：
   - 反引号 `` ` `` 代替括号

2. **throw + onerror**：
   - `window.onerror=eval;throw'=alert\x281\x29'` 绕过括号

3. **注释绕过**：
   - `-->` 是 HTML 的单行注释符，可注释掉后续内容
   - 转义后的 `//` 仍能实现注释效果

---

## 4. 修复建议汇总

### 4.1 输入验证

- 对所有用户输入进行严格的验证和过滤
- 使用白名单机制限制允许的输入
- 避免使用黑名单机制（容易被绕过）

### 4.2 输出编码

- 对用户输入进行 HTML 实体编码
- 对 JavaScript 代码中的用户输入进行 JavaScript 编码
- 使用安全的模板引擎（如 React、Vue、Angular）

### 4.3 内容安全策略

- 实施严格的内容安全策略 (CSP)
- 限制外部脚本源的加载
- 禁用内联脚本执行

### 4.4 正则表达式改进

- 考虑换行符、空格等特殊情况
- 使用 Unicode 感知的正则表达式
- 避免使用简单的黑名单正则

---

## 5. 结论

### 5.1 测试总结

本次渗透测试成功利用了 [数量] 个 XSS 漏洞，成功率 [百分比]%。测试涵盖了多种 XSS 攻击向量和绕过技术。

### 5.2 关键发现

1. [发现 1]
2. [发现 2]
3. [发现 3]

### 5.3 建议措施

1. 始终对用户输入进行编码和验证
2. 使用安全的模板引擎和框架
3. 实施严格的内容安全策略
4. 定期进行安全测试和代码审计

---

**报告生成时间**: [日期]
**报告版本**: [版本号]
**测试人员**: [姓名]
